---
# Common templates for standardized resource limits, node affinity, and monitoring
# To be included in all service deployments

# Resource limits template
resource_limits: &resource_limits
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

# Node affinity template
node_affinity: &node_affinity
  nodeSelector:
    kubernetes.io/arch: {{ node_architecture | default('arm64') }}
  affinity:
    nodeAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 1
        preference:
          matchExpressions:
          - key: node-role.kubernetes.io/worker
            operator: Exists

# Monitoring integration template
monitoring: &monitoring
  annotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "{{ metrics_port | default('8080') }}"
    prometheus.io/path: "{{ metrics_path | default('/metrics') }}"
